var MultilingualPress=window.MultilingualPress||{},MultilingualPressRedirectorSettings=window.MultilingualPressRedirectorSettings||{};MultilingualPress.RedirectorSettings=MultilingualPressRedirectorSettings,delete window.MultilingualPressRedirectorSettings,function(r,t,u){"use strict";MultilingualPress.LanguageSearch=function(a){var t,n,i,s,e,o={};this.init=function(){return t=a.closest("td"),n=r(a.data("connected")),i=t.find(".current-selection"),s=t.find(".remove-selection"),e=a.data("none"),a.autocomplete({minLength:2,select:function(t,e){return i&&i.text(e.item.label),n&&n.val(e.item.value),s&&s.show(),r(this).val(""),!1},source:function(t,e){var n,i;t.term in o?e(o[t.term]):(n=t.term,i=e,r.ajax({url:u,method:"POST",dataType:"json",data:{action:a.data("action"),search:n}}).done(function(t){return t.success&&t.data&&r.isArray(t.data)?(o[n]=t.data,i(t.data)):[]}).fail(function(){return i([])}))}}),s.click(function(t){t.preventDefault(),i.text(e),n.val(""),a.val(""),s.hide()}),this}}}(jQuery,0,ajaxurl),function(f,t,p){"use strict";MultilingualPress.NavMenu=function(s,o,r){function u(t){a.css("visibility",t?"visible":"hidden")}function e(){var t=[];return c.filter(":checked").each(function(){t.push(Number(f(this).val()||0))}),t}function n(){s.prop("disabled",!(o.length&&e().length))}function l(){alert("AJAX error.")}function i(t){var e,n,i,a;u(!0),s.prop("disabled",!0),c.prop("disabled",!0),f.ajax({url:p,method:"POST",dataType:"json",data:(e=t,n=s.data("nonce-action"),i=s.data("nonce"),(a={action:s.data("action"),mlp_sites:e,menu:r.val()})[n]=i,a)}).done(function(t){var e;t.success&&t.data&&"string"==typeof t.data?(e=f(t.data)).length?o.append(e):l():l()}).fail(function(){l()}).always(function(){u(!1),c.prop("checked",!1),c.prop("disabled",!1),s.prop("disabled",!0)})}var c,t,a,d=!1;this.init=function(){return d||(c=f(s.data("languages")),t=f(s.data("select-all")),a=s.siblings(".spinner"),c.click(function(){n()}),t.click(function(t){t.preventDefault(),c.prop("checked",!0),n()}),s.click(function(){var t=e();t&&o.length&&i(t)}),n(),d=!0),this}}}(jQuery,0,ajaxurl),function(l){"use strict";MultilingualPress.NewSiteLanguage=function(t,u){function e(){var t,e,n,i,a,s,o,r=l(this).val();i=r,(t=(a=u.find('option[data-locale="'+i+'"]')).length?a.attr("value"):null)?u.val(t):(s=r,(e=(o=u.find('option[data-iso="'+s+'"]')).length?o.attr("value"):null)?u.val(e):(n=function(t){for(var e,n=t.split("_");n.length;)if(n.pop(),(e=u.find('option[data-locale="'+n.join("_")+'"]')).length)return e.attr("value");return null}(r))&&u.val(n))}var n=!1;this.init=function(){return n||(t.change(e),n=!0),this}}}(jQuery),function(){"use strict";MultilingualPress.PostTranslationContext=function(t){var e=!1,n={};this.init=function(){return e||(n.source_site_id=t.data("source-site"),n.source_post_id=t.data("source-post"),n.remote_site_id=t.data("remote-site"),n.remote_post_id=t.data("remote-post"),n.post_type=t.data("post-type"),e=!0),this},this.sourceSiteId=function(){return Number(n.source_site_id||0)},this.sourcePostId=function(){return Number(n.source_post_id||0)},this.remoteSiteId=function(){return Number(n.remote_site_id||0)},this.remotePostId=function(){return Number(n.remote_post_id||0)},this.postType=function(){return String(n.post_type||"")}}}(jQuery),function(i){"use strict";MultilingualPress.PostTranslationTaxonomies=function(t,e){var n=!1;this.init=function(){return n||(n=!0,e.length&&t.change(function(){e.toggle(!i(this).is(":checked"))})),this}}}(jQuery),function(i){"use strict";MultilingualPress.SitesRelationshipBulkSelection=function(){function t(n){n.preventDefault(),n.stopImmediatePropagation();var t=i(".mlp-relationships-languages");t.length&&t.find('input[type="checkbox"]').each(function(t,e){e.checked="select"===i(n.currentTarget).data("action")})}var e=!1;this.init=function(){return e||(i(".mlp-site-bulk-relations").on("click",t),e=!0),this}}}(jQuery),function(){"use strict";MultilingualPress.TermTranslationContext=function(t){var e=!1,n={};this.init=function(){return e||(n.source_site_id=t.data("source-site"),n.source_term_id=t.data("source-term"),n.remote_site_id=t.data("remote-site"),n.remote_term_id=t.data("remote-term"),n.taxonomy=t.data("taxonomy"),e=!0),this},this.sourceSiteId=function(){return Number(n.source_site_id||0)},this.sourceTermId=function(){return Number(n.source_term_id||0)},this.remoteSiteId=function(){return Number(n.remote_site_id||0)},this.remoteTermId=function(){return Number(n.remote_term_id||0)},this.taxonomy=function(){return String(n.taxonomy||"")}}}(jQuery),function(t,d){"use strict";d.TranslationBoxFactory={createContext:function(t,e){return"term"===t?new d.TermTranslationContext(e):new d.PostTranslationContext(e)},create:function(t,e){var n=e.find(".tab-relation"),i=n.find(".search-input-row"),a=n.find(".update-relationship"),s=n.find(".main-row input"),o=d.TranslationBoxFactory.createContext(t,e),r=new d.TraslationBoxTabs(e),u=new d.TranslationSearch(t,o,i,a),l=new d.TranslationRelationshipUpdater(t,u,o,e),c=new d.TranslationRelationship(l,r,u,s,a);o.init(),r.init(),u.init(),c.init(),"post"===t&&new d.PostTranslationTaxonomies(e.find(".mlp-taxonomy-sync input"),e.find(".mlp-taxonomy-box")).init()}}}(jQuery,MultilingualPress),function(g,t,v){"use strict";MultilingualPress.TranslationRelationship=function(i,n,a,s,o){function r(){var t;return e||(t=n.findInPanel("relation","input, select, textarea"),e=n.findInAllPanels("input, select, textarea").not(t)),e}function u(){return s.filter(":checked").val()}function l(t){var e=t||u();if(a.hideResults(),"new"===e||"leave"===e)return r().attr("disabled",!1),n.enable(),o.hide().attr("disabled",!0),void a.showField(!1);"nothing"===e&&o.hide().attr("disabled",!0),a.showField("existing"===e),n.activate("relation"),n.disable(),r().attr("disabled",!0),"existing"!==e&&"remove"!==e||o.attr("disabled","existing"===e).show()}function c(t){(h=h||g('<span class="spinner" style="float: none; margin: 0 10px 5px;"></span>').appendTo(o.parent())).css("visibility",t?"visible":"hidden")}function d(t,e){s.attr("disabled",!0),o.attr("disabled",!0),a.hideResults(),a.showField(!1),c(!0)}function f(t,e){l(),s.attr("disabled",!1),c(!1)}function p(t,e,n){l(),s=n.find(".tab-relation").find(".main-row input"),c(!1)}function t(){if(void 0!==wp.data){var e=wp.data.select("core/edit-post");if(e instanceof Object){var n=!1;wp.data.subscribe(function(){if(-1===window.location.href.indexOf("&classic-editor")){var t=e.isSavingMetaBoxes();t===n||t||(n=t,i.updateRelation(u(),d,p,f)),n=t}})}}}var e,h,m=!1;this.init=function(){return m||(s.on("change",function(){l(g(this).val())}),o.on("click",function(t){t.preventDefault(),i.updateRelation(u(),d,p,f)}),-1!==["post-php","post-new-php"].indexOf(v)&&t(),l(),m=!0),this}}}(jQuery,0,adminpage),function(d,f,n){"use strict";f.TranslationRelationshipUpdater=function(l,a,s,c){function e(t){var e,n,i;return-1===["existing","remove","new"].indexOf(t)?null:"existing"!==t||(e=a.selectedResult())?(n="existing"===t?e:null,i={task:t,source_site_id:s.sourceSiteId(),remote_site_id:s.remoteSiteId()},"term"===l?(n=n||s.remoteTermId(),i.source_term_id=s.sourceTermId(),i.remote_term_id=n,i.action="multilingualpress_update_term_relationship"):(n=n||s.remotePostId(),i.source_post_id=s.sourcePostId(),i.remote_post_id=n,i.action="multilingualpress_update_post_relationship"),i):null}this.updateRelation=function(s,t,o,r){var u=e(s);u&&(t(s,u),d.ajax({url:n,method:"POST",dataType:"json",data:u}).done(function(t){var e,n,i,a=(e=t).success&&e.data&&"string"==typeof e.data&&(i=d(e.data)).length?((n=c.parent()).find(".mlp-warning").remove(),c.remove(),i.appendTo(n),f.TranslationBoxFactory.create(l,i),i):null;a.length?o(s,u,a):r(s,u)}).fail(function(){r(s,u)}))}}}(jQuery,MultilingualPress,ajaxurl),function(b,t,w){"use strict";MultilingualPress.TranslationSearch=function(s,o,n,r){function i(t){var e,n,i,a,s,o="object"==typeof(e=t)&&e?(n=e.id||0,i=e.title||"",n&&i?((s=(a=f.clone()).find("input")).val(n),s.attr("aria-label",i),a.find("span").text(i+" (ID: "+n+")"),a):null):null;o&&(o.find("input").on("change",function(){var t=b(this);t.is(":checked")&&(r.attr("disabled",!1),o.closest("table").find("td").removeClass("selected"),t.closest("td").addClass("selected"))}),o.appendTo(d),v++)}function a(n){var t,e,i,a=_[s]||{};n in a?g.showResults(a[n]):(s in _||(_[s]={}),l.addClass("ui-autocomplete-loading"),b.ajax({url:w,method:"POST",dataType:"json",data:(t=s,e=n,i={action:l.data("action"),search:e,source_site_id:o.sourceSiteId(),remote_site_id:o.remoteSiteId()},"term"===t?(i.source_term_id=o.sourceTermId(),i.remote_term_id=o.remoteTermId()):(i.source_post_id=o.sourcePostId(),i.remote_post_id=o.remotePostId()),i)}).done(function(t){var e=!(!t.success||!t.data)&&t.data;e&&(_[s][n]=e),g.showResults(e)}).fail(function(){g.showResults(!1)}).always(function(){l.removeClass("ui-autocomplete-loading")}))}function u(t){var e;13!==t.which&&(m&&clearTimeout(m),(e=l.val())!==h&&(e.length<2?g.hideResults(!1):(h=e,m=setTimeout(function(){a(e),h=null},300))))}var l,c,d,f,p,h,m,g=this,v=0,_={};this.init=function(){var t,e;l||((l=n.find("input")).val(""),l.keyup(u).keydown(function(t){13===t.which&&t.preventDefault()}),c=b(l.data("results")),t=(d=c.find("table tbody")).find(".search-results-row"),e=d.find(".search-results-none"),f=t.clone().show(),p=e.clone().show(),t.remove(),e.remove())},this.showField=function(t){n.toggle(t)},this.showResults=function(t){var e;e=t,v=0,d.empty(),r.attr("disabled",!0),"object"==typeof e&&e&&e.map?(e.map(i),v<1&&p.clone().appendTo(d)):p.clone().appendTo(d),c.show()},this.hideResults=function(t){d.empty(),c.hide(),!1!==t&&l.val("")},this.selectedResult=function(){var t=d.find("input:checked").eq(0);return t.length?t.val():null}}}(jQuery,0,ajaxurl),function(s){"use strict";MultilingualPress.TraslationBoxTabs=function(i){var a,n;this.init=function(){return i.tabs({active:0,activate:function(t,e){e.newTab,e.newPanel,s(this).trigger("translation-metabox-tab-activated",e)},create:function(t,e){e.tab,e.panel,s(this).trigger("translation-metabox-tab-created",e)}}),this},this.disable=function(){this.init(),i.tabs("disable")},this.enable=function(){this.init(),i.tabs("enable")},this.activate=function(t){var e=0;this.init(),t&&(n=n||i.find(".nav-tab")).each(function(){s(this).attr("id").match(/tab-([a-z-]+)$/)[1]===t&&i.tabs("option","active",e),e++})},this.findInPanel=function(t,e){var n;return(n=(a=a||i.find(".wp-tab-panel")).find(".tab-"+t)).length?n.find(e):n},this.findInAllPanels=function(t){return(a=a||i.find(".wp-tab-panel")).find(t)}}}(jQuery),function(t,e,n){"use strict";t(function(){"post-new-php"!==n&&"post-php"!==n||t(".mlp-translation-metabox").each(function(){e.TranslationBoxFactory.create("post",t(this))}),"term-php"===n&&t(".mlp-translation-metabox").each(function(){e.TranslationBoxFactory.create("term",t(this))}),"site-new-php"===n&&new e.NewSiteLanguage(t("#site-language"),t("#mlp-site-language")).init(),"sites_page_multilingualpress-site-settings"===n&&new e.LanguageSearch(t("#mlp-site-language")).init(),"site-new-php"!==n&&"sites_page_multilingualpress-site-settings"!==n||(new e.SitesRelationshipBulkSelection).init(),"nav-menus-php"===n&&new e.NavMenu(t("#mlp-languages-submit"),t("#menu-to-edit"),t("#menu")).init()})}(jQuery,MultilingualPress,adminpage);